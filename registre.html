<!DOCTYPE html>
<html lang="ca">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registre / Inici de sessió | PlayMón</title>
</head>

<body class="pt-20 lg:pt-24 bg-dark-gradient">
  <div id="app"></div>
  <script type="module" src="/src/main.js"></script>

  {{> header}}

  <main class="px-4 py-12 mx-auto max-w-3xl lg:py-16" x-data="authForm()">
    <h1 class="text-3xl font-bold text-center text-white sm:text-4xl">
      Registre / Inici de sessió
    </h1>

    <!-- Tabs -->
    <div class="flex justify-center mt-6">
      <div class="inline-flex rounded-full bg-transparent border border-[#FFA500]/70 p-1">
        <button type="button" @click="switchMode('register')"
          :class="mode==='register'
            ? 'bg-[#FFA500] text-black'
            : 'text-[#FFA500] hover:bg-orange-500/10'"
          class="px-5 py-2 text-sm font-semibold rounded-full transition-colors duration-200">
          Registrar-se
        </button>
        <button type="button" @click="switchMode('login')"
          :class="mode==='login'
            ? 'bg-[#FFA500] text-black'
            : 'text-[#FFA500] hover:bg-orange-500/10'"
          class="px-5 py-2 text-sm font-semibold rounded-full transition-colors duration-200">
          Iniciar sessió
        </button>
      </div>
    </div>

    <!-- Card -->
    <section
      class="mt-8 rounded-3xl border border-[#FFA500] bg-black/40 px-6 py-8 shadow-xl sm:px-8">
      <!-- Títol i subtítol depenent del mode -->
      <template x-if="mode === 'register'">
        <div>
          <h2 class="text-xl font-semibold text-white">
            Crea el teu compte
          </h2>
          <p class="mt-1 text-sm text-gray-300">
            Obtén una prova gratuïta de 7 dies.
          </p>
        </div>
      </template>

      <template x-if="mode === 'login'">
        <div>
          <h2 class="text-xl font-semibold text-white">
            Inicia sessió
          </h2>
          <p class="mt-1 text-sm text-gray-300">
            Accedeix al teu compte de PlayMón.
          </p>
        </div>
      </template>

      <!-- Missatges d’error / èxit -->
      <div class="mt-4 space-y-2">
        <p x-show="error" x-text="error" class="text-sm text-red-400"></p>
        <p x-show="message" x-text="message" class="text-sm text-emerald-400"></p>
        <template x-if="$store.auth.isLoggedIn">
          <p class="text-xs text-gray-400">
            Sessió actual:
            <span class="font-semibold" x-text="$store.auth.user?.username"></span>
            (<span x-text="$store.auth.user?.email"></span>)
          </p>
        </template>
      </div>

      <!-- Formulari -->
      <form @submit.prevent="submit" class="mt-6 space-y-4">
        <!-- Nom d'usuari només en registre -->
        <div x-show="mode === 'register'">
          <label class="block text-sm font-medium text-gray-200">
            Nom d'usuari
          </label>
          <input type="text" x-model="username" placeholder="Nom d'usuari"
            class="mt-1 w-full rounded-md border border-gray-700 bg-black/40 px-3 py-2 text-sm text-gray-100 placeholder-gray-500 outline-none ring-0 focus:border-[#FFA500] focus:ring-2 focus:ring-[#FFA500]/60" />
        </div>

        <!-- Correu electrònic -->
        <div>
          <label class="block text-sm font-medium text-gray-200">
            Correu electrònic
          </label>
          <input type="email" x-model="email" placeholder="correu@exemple.com"
            class="mt-1 w-full rounded-md border border-gray-700 bg-black/40 px-3 py-2 text-sm text-gray-100 placeholder-gray-500 outline-none ring-0 focus:border-[#FFA500] focus:ring-2 focus:ring-[#FFA500]/60" />
        </div>

        <!-- Contrasenya -->
        <div>
          <label class="block text-sm font-medium text-gray-200">
            Contrasenya
          </label>
          <input type="password" x-model="password" placeholder="Contrasenya"
            class="mt-1 w-full rounded-md border border-gray-700 bg-black/40 px-3 py-2 text-sm text-gray-100 placeholder-gray-500 outline-none ring-0 focus:border-[#FFA500] focus:ring-2 focus:ring-[#FFA500]/60" />
          <p class="mt-1 text-xs text-gray-400">
            Mínim 6 caràcters (només per a simulació, no és un sistema real de seguretat).
          </p>
        </div>

        <!-- Confirmació només en registre -->
        <div x-show="mode === 'register'">
          <label class="block text-sm font-medium text-gray-200">
            Repeteix la contrasenya
          </label>
          <input type="password" x-model="confirmPassword" placeholder="Repeteix la contrasenya"
            class="mt-1 w-full rounded-md border border-gray-700 bg-black/40 px-3 py-2 text-sm text-gray-100 placeholder-gray-500 outline-none ring-0 focus:border-[#FFA500] focus:ring-2 focus:ring-[#FFA500]/60" />
        </div>

        <!-- Botó -->
        <div class="pt-2">
          <button type="submit" :disabled="loading"
            class="w-full rounded-full bg-[#FFA500] px-4 py-2 text-sm font-semibold text-black shadow-lg transition hover:bg-orange-500 disabled:cursor-not-allowed disabled:opacity-70">
            <span x-show="mode === 'register' && !loading">
              Registrar-se i provar 7 dies gratis
            </span>
            <span x-show="mode === 'login' && !loading">
              Iniciar sessió
            </span>
            <span x-show="loading">Processant...</span>
          </button>
        </div>
      </form>

      <!-- Enllaç per canviar de mode -->
      <p class="mt-6 text-sm text-center text-gray-300">
        <span x-show="mode === 'register'">
          Ja tens compte?
          <button type="button" @click="switchMode('login')"
            class="font-semibold text-white underline-offset-2 hover:underline">
            Inicia sessió
          </button>
        </span>

        <span x-show="mode === 'login'">
          Encara no tens compte?
          <button type="button" @click="switchMode('register')"
            class="font-semibold text-white underline-offset-2 hover:underline">
            Registra't ara
          </button>
        </span>
      </p>
    </section>
  </main>

  {{> _footer }}
</body>

</html>
